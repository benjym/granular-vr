"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkgranular_vr"] = self["webpackChunkgranular_vr"] || []).push([["src_4d-pool_js"],{

/***/ "./libs/NDSTLLoader.js":
/*!*****************************!*\
  !*** ./libs/NDSTLLoader.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"NDSTLLoader\": () => (/* binding */ NDSTLLoader),\n/* harmony export */   \"renderSTL\": () => (/* binding */ renderSTL)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! three */ \"./node_modules/three/build/three.module.js\");\n/* harmony import */ var three_examples_jsm_geometries_ConvexGeometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! three/examples/jsm/geometries/ConvexGeometry.js */ \"./node_modules/three/examples/jsm/geometries/ConvexGeometry.js\");\n/* harmony import */ var three_examples_jsm_helpers_VertexNormalsHelper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! three/examples/jsm/helpers/VertexNormalsHelper.js */ \"./node_modules/three/examples/jsm/helpers/VertexNormalsHelper.js\");\n\n\n\n\n\n\n/**\n * Description: A THREE loader for STL ASCII files, as created by Solidworks and other CAD programs.\n *\n * Supports both binary and ASCII encoded files, with automatic detection of type.\n *\n * The loader returns a non-indexed buffer geometry.\n *\n * Limitations:\n *  Binary decoding supports \"Magics\" color format (http://en.wikipedia.org/wiki/STL_(file_format)#Color_in_binary_STL).\n *  There is perhaps some question as to how valid it is to always assume little-endian-ness.\n *  ASCII decoding assumes file is UTF-8.\n *\n * Usage:\n *  const loader = new STLLoader();\n *  loader.load( './models/stl/slotted_disk.stl', function ( geometry ) {\n *    scene.add( new THREE.Mesh( geometry ) );\n *  });\n *\n * For binary STLs geometry might contain colors for vertices. To use it:\n *  // use the same code to load STL as above\n *  if (geometry.hasColors) {\n *    material = new THREE.MeshPhongMaterial({ opacity: geometry.alpha, vertexColors: true });\n *  } else { .... }\n *  const mesh = new THREE.Mesh( geometry, material );\n *\n * For ASCII STLs containing multiple solids, each solid is assigned to a different group.\n * Groups can be used to assign a different color by defining an array of materials with the same length of\n * geometry.groups and passing it to the Mesh constructor:\n *\n * const mesh = new THREE.Mesh( geometry, material );\n *\n * For example:\n *\n *  const materials = [];\n *  const nGeometryGroups = geometry.groups.length;\n *\n *  const colorMap = ...; // Some logic to index colors.\n *\n *  for (let i = 0; i < nGeometryGroups; i++) {\n *\n *\t\tconst material = new THREE.MeshPhongMaterial({\n *\t\t\tcolor: colorMap[i],\n *\t\t\twireframe: false\n *\t\t});\n *\n *  }\n *\n *  materials.push(material);\n *  const mesh = new THREE.Mesh(geometry, materials);\n */\n\n\nclass NDSTLLoader extends three__WEBPACK_IMPORTED_MODULE_2__.Loader {\n\n\tconstructor(manager) {\n\n\t\tsuper(manager);\n\n\t}\n\n\tload(url, onLoad, onProgress, onError) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new three__WEBPACK_IMPORTED_MODULE_2__.FileLoader(this.manager);\n\t\tloader.setPath(this.path);\n\t\tloader.setResponseType('arraybuffer');\n\t\tloader.setRequestHeader(this.requestHeader);\n\t\tloader.setWithCredentials(this.withCredentials);\n\n\t\tloader.load(url, function (text) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad(scope.parse(text));\n\n\t\t\t} catch (e) {\n\n\t\t\t\tif (onError) {\n\n\t\t\t\t\tonError(e);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error(e);\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError(url);\n\n\t\t\t}\n\n\t\t}, onProgress, onError);\n\n\t}\n\n\tparse(data) {\n\n\t\tfunction isBinary(data) {\n\n\t\t\tconst reader = new DataView(data);\n\t\t\tconst face_size = (32 / 8 * 3) + ((32 / 8 * 3) * 3) + (16 / 8);\n\t\t\tconst n_faces = reader.getUint32(80, true);\n\t\t\tconst expect = 80 + (32 / 8) + (n_faces * face_size);\n\n\t\t\tif (expect === reader.byteLength) {\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\t// An ASCII STL data must begin with 'solid ' as the first six bytes.\n\t\t\t// However, ASCII STLs lacking the SPACE after the 'd' are known to be\n\t\t\t// plentiful.  So, check the first 5 bytes for 'solid'.\n\n\t\t\t// Several encodings, such as UTF-8, precede the text with up to 5 bytes:\n\t\t\t// https://en.wikipedia.org/wiki/Byte_order_mark#Byte_order_marks_by_encoding\n\t\t\t// Search for \"solid\" to start anywhere after those prefixes.\n\n\t\t\t// US-ASCII ordinal values for 's', 'o', 'l', 'i', 'd'\n\n\t\t\tconst solid = [115, 111, 108, 105, 100];\n\n\t\t\tfor (let off = 0; off < 5; off++) {\n\n\t\t\t\t// If \"solid\" text is matched to the current offset, declare it to be an ASCII STL.\n\n\t\t\t\tif (matchDataViewAt(solid, reader, off)) return false;\n\n\t\t\t}\n\n\t\t\t// Couldn't find \"solid\" text at the beginning; it is binary STL.\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tfunction matchDataViewAt(query, reader, offset) {\n\n\t\t\t// Check if each byte in query matches the corresponding byte from the current offset\n\n\t\t\tfor (let i = 0, il = query.length; i < il; i++) {\n\n\t\t\t\tif (query[i] !== reader.getUint8(offset + i)) return false;\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tfunction parseBinary(data) {\n\n\t\t\tconst reader = new DataView(data);\n\t\t\tconst faces = reader.getUint32(80, true);\n\n\t\t\tlet r, g, b, hasColors = false, colors;\n\t\t\tlet defaultR, defaultG, defaultB, alpha;\n\n\t\t\t// process STL header\n\t\t\t// check for default color in header (\"COLOR=rgba\" sequence).\n\n\t\t\tfor (let index = 0; index < 80 - 10; index++) {\n\n\t\t\t\tif ((reader.getUint32(index, false) == 0x434F4C4F /*COLO*/) &&\n\t\t\t\t\t(reader.getUint8(index + 4) == 0x52 /*'R'*/) &&\n\t\t\t\t\t(reader.getUint8(index + 5) == 0x3D /*'='*/)) {\n\n\t\t\t\t\thasColors = true;\n\t\t\t\t\tcolors = new Float32Array(faces * 3 * 3);\n\n\t\t\t\t\tdefaultR = reader.getUint8(index + 6) / 255;\n\t\t\t\t\tdefaultG = reader.getUint8(index + 7) / 255;\n\t\t\t\t\tdefaultB = reader.getUint8(index + 8) / 255;\n\t\t\t\t\talpha = reader.getUint8(index + 9) / 255;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst dataOffset = 84;\n\t\t\tconst faceLength = 12 * 4 + 2;\n\n\t\t\tconst geometry = new three__WEBPACK_IMPORTED_MODULE_2__.BufferGeometry();\n\n\t\t\tconst vertices = new Float32Array(faces * 3 * 3);\n\t\t\tconst normals = new Float32Array(faces * 3 * 3);\n\n\t\t\tfor (let face = 0; face < faces; face++) {\n\n\t\t\t\tconst start = dataOffset + face * faceLength;\n\t\t\t\tconst normalX = reader.getFloat32(start, true);\n\t\t\t\tconst normalY = reader.getFloat32(start + 4, true);\n\t\t\t\tconst normalZ = reader.getFloat32(start + 8, true);\n\n\t\t\t\tif (hasColors) {\n\n\t\t\t\t\tconst packedColor = reader.getUint16(start + 48, true);\n\n\t\t\t\t\tif ((packedColor & 0x8000) === 0) {\n\n\t\t\t\t\t\t// facet has its own unique color\n\n\t\t\t\t\t\tr = (packedColor & 0x1F) / 31;\n\t\t\t\t\t\tg = ((packedColor >> 5) & 0x1F) / 31;\n\t\t\t\t\t\tb = ((packedColor >> 10) & 0x1F) / 31;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tr = defaultR;\n\t\t\t\t\t\tg = defaultG;\n\t\t\t\t\t\tb = defaultB;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfor (let i = 1; i <= 3; i++) {\n\n\t\t\t\t\tconst vertexstart = start + i * 12;\n\t\t\t\t\tconst componentIdx = (face * 3 * 3) + ((i - 1) * 3);\n\n\t\t\t\t\tvertices[componentIdx] = reader.getFloat32(vertexstart, true);\n\t\t\t\t\tvertices[componentIdx + 1] = reader.getFloat32(vertexstart + 4, true);\n\t\t\t\t\tvertices[componentIdx + 2] = reader.getFloat32(vertexstart + 8, true);\n\n\t\t\t\t\tnormals[componentIdx] = normalX;\n\t\t\t\t\tnormals[componentIdx + 1] = normalY;\n\t\t\t\t\tnormals[componentIdx + 2] = normalZ;\n\n\t\t\t\t\tif (hasColors) {\n\n\t\t\t\t\t\tcolors[componentIdx] = r;\n\t\t\t\t\t\tcolors[componentIdx + 1] = g;\n\t\t\t\t\t\tcolors[componentIdx + 2] = b;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute('position', new three__WEBPACK_IMPORTED_MODULE_2__.BufferAttribute(vertices, 3));\n\t\t\tgeometry.setAttribute('normal', new three__WEBPACK_IMPORTED_MODULE_2__.BufferAttribute(normals, 3));\n\n\t\t\tif (hasColors) {\n\n\t\t\t\tgeometry.setAttribute('color', new three__WEBPACK_IMPORTED_MODULE_2__.BufferAttribute(colors, 3));\n\t\t\t\tgeometry.hasColors = true;\n\t\t\t\tgeometry.alpha = alpha;\n\n\t\t\t}\n\n\t\t\treturn geometry;\n\n\t\t}\n\n\t\tfunction parseASCII(data) {\n\t\t\tvar N;\n\n\t\t\tvar patternDimension = /solid ([0-9]+)/g;\n\t\t\tvar patternSolid = /solid([\\s\\S]*?)endsolid/g;\n\t\t\tvar patternFace = /facet([\\s\\S]*?)endfacet/g;\n\n\t\t\twhile ((result = patternDimension.exec(data)) !== null) {\n\t\t\t\tN = parseInt(result[1]);\n\t\t\t}\n\n\t\t\tvar patternFloat = /[\\s]+([+-]?(?:\\d*)(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/.source;\n\t\t\tvar patternFloats = patternFloat.repeat(N);\n\t\t\tvar patternVertex = new RegExp('vertex' + patternFloats, 'g');\n\t\t\tvar patternNormal = new RegExp('normal' + patternFloats, 'g');\n\n\t\t\tvar result;\n\n\t\t\tvar solids = [];\n\n\t\t\twhile ((result = patternSolid.exec(data)) !== null) { // for each solid\n\n\t\t\t\tvar solid_text = result[0];\n\t\t\t\tvar solid = [];\n\n\t\t\t\twhile ((result = patternFace.exec(solid_text)) !== null) { // for each facet\n\n\t\t\t\t\tvar facet_text = result[0];\n\t\t\t\t\tvar facet = [];\n\t\t\t\t\twhile ((result = patternVertex.exec(facet_text)) !== null) {  // get the N vertices\n\t\t\t\t\t\tvar vertex = [];\n\t\t\t\t\t\tfor (var i = 1; i <= N; i++) {\n\t\t\t\t\t\t\tvertex.push(parseFloat(result[i]));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfacet.push(vertex);\n\t\t\t\t\t}\n\t\t\t\t\tsolid.push(facet);\n\n\t\t\t\t}\n\t\t\t\tsolids.push(solid);\n\t\t\t}\n\t\t\treturn solids;\n\n\t\t}\n\n\t\tfunction ensureString(buffer) {\n\n\t\t\tif (typeof buffer !== 'string') {\n\n\t\t\t\treturn three__WEBPACK_IMPORTED_MODULE_2__.LoaderUtils.decodeText(new Uint8Array(buffer));\n\n\t\t\t}\n\n\t\t\treturn buffer;\n\n\t\t}\n\n\t\tfunction ensureBinary(buffer) {\n\n\t\t\tif (typeof buffer === 'string') {\n\n\t\t\t\tconst array_buffer = new Uint8Array(buffer.length);\n\t\t\t\tfor (let i = 0; i < buffer.length; i++) {\n\n\t\t\t\t\tarray_buffer[i] = buffer.charCodeAt(i) & 0xff; // implicitly assumes little-endian\n\n\t\t\t\t}\n\n\t\t\t\treturn array_buffer.buffer || array_buffer;\n\n\t\t\t} else {\n\n\t\t\t\treturn buffer;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// start\n\n\t\treturn parseASCII(ensureString(data));\n\t\t// const binData = ensureBinary( data );\n\n\t\t// return isBinary( binData ) ? parseBinary( binData ) : parseASCII( ensureString( data ) );\n\n\t}\n\n}\n\nfunction pushUnique(arr, new_entry) {\n\tlet added = false;\n\tlet found = false;\n\tlet tol = 1e-6;\n\tif (arr.length === 0) { // add first entry\n\t\tarr.push(new_entry[0], new_entry[1], new_entry[2]);\n\t\tadded = true;\n\t}\n\telse {\n\t\tfor (var i = 0; i < arr.length / 3; i++) {\n\t\t\tif (Math.abs(arr[i * 3] - new_entry[0]) < tol &&\n\t\t\t\tMath.abs(arr[i * 3 + 1] - new_entry[1]) < tol &&\n\t\t\t\tMath.abs(arr[i * 3 + 2] - new_entry[2]) < tol) {\n\t\t\t\tfound = true;\n\t\t\t}\n\t\t}\n\t\tif (found === false) {\n\t\t\tarr.push(new_entry[0], new_entry[1], new_entry[2]);\n\t\t\tadded = true;\n\t\t}\n\t}\n\treturn added\n}\n\nfunction calculateNormal(points) {\n\tlet ux = points[1][0] - points[0][0];\n\tlet uy = points[1][1] - points[0][1];\n\tlet uz = points[1][2] - points[0][2];\n\tlet vx = points[2][0] - points[0][0];\n\tlet vy = points[2][1] - points[0][1];\n\tlet vz = points[2][2] - points[0][2];\n\n\tlet u_cross_v = [uy * vz - uz * vy, uz * vx - ux * vz, ux * vy - uy * vx] //cross product\n\treturn u_cross_v;\n}\n\n\n\nfunction renderSTL(meshes, NDsolids, scene, material, x4) {\n\n\tvar vertices, normals;\n\tvar N = NDsolids[0][0][0].length; // get dimension from vertex length\n\n\tNDsolids.forEach((solid, i) => {\n\t\tvar geometry = new three__WEBPACK_IMPORTED_MODULE_2__.BufferGeometry();\n\t\tvertices = [];\n\t\tnormals = [];\n\t\tlet tol = 1e-6;\n\t\tlet added, alpha;\n\t\tsolid.forEach((facet, j) => {\n\t\t\tvar normal = calculateNormal(facet);\n\t\t\tfacet.forEach((vertex, k) => {\n\t\t\t\tif (N == 3) {\n\t\t\t\t\tadded = pushUnique(vertices, vertex);\n\t\t\t\t\tif (added) { normals.push(normal[0], normal[1], normal[2]); }\n\t\t\t\t}\n\t\t\t\telse if (N == 4) {\n\t\t\t\t\t// loop through all other vertices in facet\n\t\t\t\t\tfor (var l = k + 1; l < N; l++) {\n\t\t\t\t\t\talpha = (x4 - vertex[N - 1]) / (facet[l][N - 1] - vertex[N - 1]);\n\t\t\t\t\t\tif (Math.abs(vertex[N - 1] - x4) < tol && Math.abs(facet[l][N - 1] - x4) < tol) {\n\t\t\t\t\t\t\t// alpha is not defined, we are coincident with x4, add both points\n\t\t\t\t\t\t\tadded = pushUnique(vertices, vertex);\n\t\t\t\t\t\t\tif (added) { normals.push(normal[0], normal[1], normal[2]); }\n\t\t\t\t\t\t\tadded = pushUnique(vertices, facet[l]);\n\t\t\t\t\t\t\tif (added) { normals.push(normal[0], normal[1], normal[2]); }\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (alpha >= 0 && alpha <= 1) { // alpha is in range\n\t\t\t\t\t\t\tlet sliced_vertex = [];\n\t\t\t\t\t\t\tfor (var n = 0; n < 3; n++) {\n\t\t\t\t\t\t\t\tsliced_vertex.push(vertex[n] + alpha * (facet[l][n] - vertex[n]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tadded = pushUnique(vertices, sliced_vertex);\n\t\t\t\t\t\t\tif (added) { normals.push(normal[0], normal[1], normal[2]); }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tgeometry.setAttribute('position', new three__WEBPACK_IMPORTED_MODULE_2__.Float32BufferAttribute(vertices, 3));\n\t\tgeometry.setAttribute('normal', new three__WEBPACK_IMPORTED_MODULE_2__.Float32BufferAttribute(normals, 3));\n\n\t\tlet points = [];\n\t\t// for ( let i=0; i<vertices.length/3; i++ ) { points.push( new Vector3( vertices[i*3]   + Math.random()*1e-6,\n\t\t//                                                                       vertices[i*3+1] + Math.random()*1e-6,\n\t\t//                                                                       vertices[i*3+2] + Math.random()*1e-6\n\t\t//                                                                      ) ) };\n\t\tfor (let i = 0; i < vertices.length / 3; i++) {\n\t\t\tpoints.push(new three__WEBPACK_IMPORTED_MODULE_2__.Vector3(vertices[i * 3],\n\t\t\t\tvertices[i * 3 + 1],\n\t\t\t\tvertices[i * 3 + 2]\n\t\t\t)\n\t\t\t)\n\t\t};\n\n\t\tlet min_val = 0.005;\n\t\tlet WHD = new three__WEBPACK_IMPORTED_MODULE_2__.Vector3();\n\t\tlet center = new three__WEBPACK_IMPORTED_MODULE_2__.Vector3();\n\t\tif (points.length > 3) {\n\t\t\t// geometry = new ConvexGeometry( points ); // causing all kinds of problems for planes\n\t\t\tconst box = new three__WEBPACK_IMPORTED_MODULE_2__.Box3();\n\t\t\tbox.setFromPoints(points);\n\t\t\tbox.getSize(WHD);\n\t\t\tbox.getCenter(center);\n\t\t\tWHD.clampScalar(min_val, 1e4); // set a minimum width\n\t\t\tgeometry = new three__WEBPACK_IMPORTED_MODULE_2__.BoxGeometry(WHD.x, WHD.y, WHD.z);\n\t\t}\n\n\t\tvar this_mesh = new three__WEBPACK_IMPORTED_MODULE_2__.Mesh(geometry, material);\n\t\tthis_mesh.position.set(center.x, center.y - min_val, center.z);\n\t\tthis_mesh.castShadow = true;\n\t\tthis_mesh.receiveShadow = true;\n\n\t\tmeshes.add(this_mesh);\n\t});\n\n\t// meshes.castShadow = true;\n\t// meshes.receiveShadow = true;\n\n\t// console.log(meshes)\n\n\t// console.log(meshes)\n\tmeshes.remove_me = true;\n\treturn meshes\n}\n\n\n\n\n//# sourceURL=webpack://granular-vr/./libs/NDSTLLoader.js?");

/***/ }),

/***/ "./libs/PoolCue.js":
/*!*************************!*\
  !*** ./libs/PoolCue.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"add_pool_cue\": () => (/* binding */ add_pool_cue),\n/* harmony export */   \"pool_cue\": () => (/* binding */ pool_cue),\n/* harmony export */   \"small_end_radius\": () => (/* binding */ small_end_radius),\n/* harmony export */   \"small_sphere\": () => (/* binding */ small_sphere)\n/* harmony export */ });\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! three */ \"./node_modules/three/build/three.module.js\");\nlet pool_cue, small_end_radius, small_sphere;\n\n\n\nfunction add_pool_cue( target ) {\n    pool_cue = new three__WEBPACK_IMPORTED_MODULE_0__.Group();\n\n    small_end_radius = 0.02; // any smaller and things go very poorly (at least using the webxr fake platform with apparently large step sizes)\n    let large_end_radius = 0.06;\n    let length = 1.4;\n\n    const cylinder_geometry = new three__WEBPACK_IMPORTED_MODULE_0__.CylinderGeometry( small_end_radius, large_end_radius, length, 16 );\n    cylinder_geometry.applyMatrix4( new three__WEBPACK_IMPORTED_MODULE_0__.Matrix4().makeRotationX( -Math.PI / 2 ) ); // rotate the geometry to make the forces point in the right direction\n    const wood_material = new three__WEBPACK_IMPORTED_MODULE_0__.MeshStandardMaterial( {color: 0x5d2906} ); // wood colour\n    const cylinder = new three__WEBPACK_IMPORTED_MODULE_0__.Mesh( cylinder_geometry, wood_material );\n    pool_cue.add(cylinder);\n\n    const small_sphere_geometry = new three__WEBPACK_IMPORTED_MODULE_0__.SphereGeometry( small_end_radius, 32, 16 );\n    const chalk = new three__WEBPACK_IMPORTED_MODULE_0__.MeshStandardMaterial( {color: 0xffffff} ); // chalk colour\n    small_sphere = new three__WEBPACK_IMPORTED_MODULE_0__.Mesh( small_sphere_geometry, chalk );\n\n    pool_cue.add(small_sphere);\n    small_sphere.position.z = -length/2.;\n\n    const large_sphere_geometry = new three__WEBPACK_IMPORTED_MODULE_0__.SphereGeometry( large_end_radius, 32, 16 );\n    const large_sphere = new three__WEBPACK_IMPORTED_MODULE_0__.Mesh( large_sphere_geometry, wood_material );\n\n    pool_cue.add(large_sphere);\n    large_sphere.position.z = length/2.;\n\n    pool_cue.position.z = -length/4.\n\n    target.add( pool_cue );\n}\n\n\n//# sourceURL=webpack://granular-vr/./libs/PoolCue.js?");

/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./css/main.css":
/*!************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./css/main.css ***!
  \************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/noSourceMaps.js */ \"./node_modules/css-loader/dist/runtime/noSourceMaps.js\");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/api.js */ \"./node_modules/css-loader/dist/runtime/api.js\");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"html * {\\n  font-family: 'Montserrat', sans-serif;\\n}\\n\\nbody { margin: 0; }\\n\\n.button {\\n    align-items: center;\\n    border: 1px solid transparent;\\n    border-radius: 4px;\\n    box-shadow: none;\\n    display: inline-flex;\\n    font-size: 1rem;\\n    height: 2.5em;\\n    justify-content: flex-start;\\n    line-height: 1.5;\\n    padding-bottom: calc(0.5em - 1px);\\n    padding-left: calc(0.75em - 1px);\\n    padding-right: calc(0.75em - 1px);\\n    padding-top: calc(0.5em - 1px);\\n    position: relative;\\n    vertical-align: top;\\n  }\\n   .button:focus, .button:active {\\n    outline: none;\\n  }\\n  \\n   .button {\\n    -webkit-touch-callout: none;\\n    -webkit-user-select: none;\\n    -moz-user-select: none;\\n    user-select: none;\\n  }\\n\\n\\n#buttonsContainer {\\n    position: absolute;\\n    bottom: 5px;\\n    right: 5px;\\n    z-index: 3;\\n  }\\n\\n.lil-gui {\\n  --number-color: #fc2eff;\\n  --string-color: #fc2eff;\\n}\", \"\"]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n//# sourceURL=webpack://granular-vr/./css/main.css?./node_modules/css-loader/dist/cjs.js");

/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./css/pool.css":
/*!************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./css/pool.css ***!
  \************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/noSourceMaps.js */ \"./node_modules/css-loader/dist/runtime/noSourceMaps.js\");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/api.js */ \"./node_modules/css-loader/dist/runtime/api.js\");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"canvas { width: 100%; height: 100% }\\n#N_tag {\\n    color: white;\\n    padding: 24px;\\n    font: 48px Montserrat;\\n    /* font-weight: bold; */\\n    position:absolute;\\n}\\n#stats {\\n    position: absolute;\\n    width: 300px;\\n    height: 200px;\\n    margin: 0;\\n    padding: 0;\\n}\\n#hit_me {\\n    font-weight: bold;\\n    position:absolute;\\n    margin-left: auto;\\n    margin-right: auto;\\n    left: 0;\\n    right: 0;\\n    bottom: 5pt;\\n    text-align: center;\\n    font-size: 14pt;\\n    z-index: 1;\\n    color: #fff;\\n}\\n#web_instructions {\\n    font-weight: bold;\\n    position:absolute;\\n    margin-left: auto;\\n    margin-right: auto;\\n    left: 0;\\n    right: 0;\\n    bottom: 5pt;\\n    text-align: center;\\n    font-size: 14pt;\\n    z-index: 1;\\n    color: #fff;\\n}\\n#hit_me:active {\\n    color: #777;\\n}\\n#overlay {\\n    position: absolute;\\n    font-size: 16px;\\n    z-index: 2;\\n    top: 0;\\n    left: 0;\\n    width: 100%;\\n    height: 100%;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    flex-direction: column;\\n    background: rgba(0,0,0,0.7);\\n}\\n\\n#overlay button {\\n    background: transparent;\\n    border: 0;\\n    border: 1px solid rgb(255, 255, 255);\\n    border-radius: 4px;\\n    color: #00ff00;\\n    padding: 12px 18px;\\n    text-transform: uppercase;\\n    cursor: pointer;\\n}\", \"\"]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n//# sourceURL=webpack://granular-vr/./css/pool.css?./node_modules/css-loader/dist/cjs.js");

/***/ }),

/***/ "./css/main.css":
/*!**********************!*\
  !*** ./css/main.css ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ \"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleDomAPI.js */ \"./node_modules/style-loader/dist/runtime/styleDomAPI.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertBySelector.js */ \"./node_modules/style-loader/dist/runtime/insertBySelector.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js */ \"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertStyleElement.js */ \"./node_modules/style-loader/dist/runtime/insertStyleElement.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleTagTransform.js */ \"./node_modules/style-loader/dist/runtime/styleTagTransform.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _node_modules_css_loader_dist_cjs_js_main_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! !!../node_modules/css-loader/dist/cjs.js!./main.css */ \"./node_modules/css-loader/dist/cjs.js!./css/main.css\");\n\n      \n      \n      \n      \n      \n      \n      \n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = (_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default());\noptions.setAttributes = (_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default());\n\n      options.insert = _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default().bind(null, \"head\");\n    \noptions.domAPI = (_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default());\noptions.insertStyleElement = (_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default());\n\nvar update = _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_main_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"], options);\n\n\n\n\n       /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_css_loader_dist_cjs_js_main_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"] && _node_modules_css_loader_dist_cjs_js_main_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"].locals ? _node_modules_css_loader_dist_cjs_js_main_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"].locals : undefined);\n\n\n//# sourceURL=webpack://granular-vr/./css/main.css?");

/***/ }),

/***/ "./css/pool.css":
/*!**********************!*\
  !*** ./css/pool.css ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ \"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleDomAPI.js */ \"./node_modules/style-loader/dist/runtime/styleDomAPI.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertBySelector.js */ \"./node_modules/style-loader/dist/runtime/insertBySelector.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js */ \"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/insertStyleElement.js */ \"./node_modules/style-loader/dist/runtime/insertStyleElement.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! !../node_modules/style-loader/dist/runtime/styleTagTransform.js */ \"./node_modules/style-loader/dist/runtime/styleTagTransform.js\");\n/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _node_modules_css_loader_dist_cjs_js_pool_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! !!../node_modules/css-loader/dist/cjs.js!./pool.css */ \"./node_modules/css-loader/dist/cjs.js!./css/pool.css\");\n\n      \n      \n      \n      \n      \n      \n      \n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = (_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default());\noptions.setAttributes = (_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default());\n\n      options.insert = _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default().bind(null, \"head\");\n    \noptions.domAPI = (_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default());\noptions.insertStyleElement = (_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default());\n\nvar update = _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_pool_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"], options);\n\n\n\n\n       /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_css_loader_dist_cjs_js_pool_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"] && _node_modules_css_loader_dist_cjs_js_pool_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"].locals ? _node_modules_css_loader_dist_cjs_js_pool_css__WEBPACK_IMPORTED_MODULE_6__[\"default\"].locals : undefined);\n\n\n//# sourceURL=webpack://granular-vr/./css/pool.css?");

/***/ }),

/***/ "./src/4d-pool.js":
/*!************************!*\
  !*** ./src/4d-pool.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"init\": () => (/* binding */ init)\n/* harmony export */ });\n/* harmony import */ var _css_main_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../css/main.css */ \"./css/main.css\");\n/* harmony import */ var _css_pool_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../css/pool.css */ \"./css/pool.css\");\n/* harmony import */ var _text_to_speech_4d_pool_mp3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../text-to-speech/4d-pool.mp3 */ \"./text-to-speech/4d-pool.mp3\");\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! three */ \"./node_modules/three/build/three.module.js\");\n/* harmony import */ var three_examples_jsm_libs_lil_gui_module_min_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! three/examples/jsm/libs/lil-gui.module.min.js */ \"./node_modules/three/examples/jsm/libs/lil-gui.module.min.js\");\n/* harmony import */ var _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../libs/SphereHandler.js */ \"./libs/SphereHandler.js\");\n/* harmony import */ var _libs_NDSTLLoader_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../libs/NDSTLLoader.js */ \"./libs/NDSTLLoader.js\");\n/* harmony import */ var _libs_controllers_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../libs/controllers.js */ \"./libs/controllers.js\");\n/* harmony import */ var _libs_buttons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../libs/buttons */ \"./libs/buttons.js\");\n/* harmony import */ var _libs_PoolCue_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../libs/PoolCue.js */ \"./libs/PoolCue.js\");\n/* harmony import */ var _libs_audio_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../libs/audio.js */ \"./libs/audio.js\");\n/* harmony import */ var _libs_lights__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../libs/lights */ \"./libs/lights.js\");\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./index */ \"./src/index.js\");\n\n\n\n\n\n// import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\n\n// import { VRButton } from 'three/examples/jsm/webxr/VRButton.js';\n\n\n// import * as WALLS from \"../libs/WallHandler.js\"\n// import * as LAYOUT from '../libs/Layout.js'\n\n\n\n\n\n\n\n\n// import { PoolTableShader } from '../libs/PoolTableShader.js';\n\nconst N_tag = document.createElement(\"div\");\nN_tag.id = \"N_tag\";\nN_tag.innerHTML = \"0\";\ndocument.body.appendChild(N_tag)\n\nconst hit_me = document.createElement(\"div\");\nhit_me.id = \"hit_me\";\nhit_me.innerHTML = \"Shoot\";\ndocument.body.appendChild(hit_me)\n\nconst web_instructions = document.createElement(\"div\");\nweb_instructions.id = \"web_instructions\";\nweb_instructions.innerHTML = \"Press Enter to shoot.\";\ndocument.body.appendChild(web_instructions)\n\nvar urlParams = new URLSearchParams(window.location.search);\n\n\n\nlet gui;\nlet S;\nlet x;\nlet NDsolids, material, STLFilename;\nlet meshes;\nvar direction = new three__WEBPACK_IMPORTED_MODULE_12__.Vector3();\n// const mouse = new THREE.Vector2();\n\nvar params = {\n    radius: 0.05,\n    dimension: 4,\n    L1: 2,\n    L2: 0.1,  // this is the direction of gravity\n    L3: 1,\n    L4: 0.5,\n    pocket_size: 0.15,\n    pyramid_size: 5,\n    d4: { cur: 0 },\n    particle_density: 2700,\n    track_white_ball: true,\n    strength: 0.5,\n    quality: 7,\n    dt: 1e-3,\n    table_height: 1.,\n    lut: 'None',\n    audio: false,\n}\n\nparams.N = get_num_particles(params.pyramid_size);\nif (urlParams.has('vr') || urlParams.has('VR')) {\n    params.vr = true;\n    params.N_real = params.N + 1;\n}\nelse {\n    params.vr = false;\n    params.N_real = params.N;\n}\n\nparams.d4.min = -params.L4;\nparams.d4.max = params.L4;\n\nparams.particle_volume = Math.PI * Math.PI * Math.pow(params.radius, 4) / 2.;\nparams.particle_mass = params.particle_volume * params.particle_density;\n\nlet sunk_balls = [];\n\nasync function init() {\n    _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.createNDParticleShader(params).then(main());\n}\n\n// SPHERES.createNDParticleShader(params);\n\n// const startButton = document.getElementById( 'startButton' );\n// startButton.addEventListener( 'click', init );\n\nasync function main() {\n\n    // const overlay = document.getElementById( 'overlay' );\n    // overlay.remove();\n\n    await NDDEMPhysics();\n\n    // camera = new THREE.PerspectiveCamera( 15, window.innerWidth / window.innerHeight, 0.1, 1000 );\n    // camera.position.set( 3*params.L1, 2*params.L1 + params.table_height, 0 );\n\n    // camera.up.set(0, 0, 1);\n\n    // scene = new THREE.Scene();\n\n    const base_geometry = new three__WEBPACK_IMPORTED_MODULE_12__.PlaneGeometry(4 * params.L1, 2 * params.L3 + 2 * params.L1);\n    const base_material = new three__WEBPACK_IMPORTED_MODULE_12__.MeshBasicMaterial({ color: 0x333333, side: three__WEBPACK_IMPORTED_MODULE_12__.DoubleSide });\n    const plane = new three__WEBPACK_IMPORTED_MODULE_12__.Mesh(base_geometry, base_material);\n    plane.rotateX(Math.PI / 2.);\n    _index__WEBPACK_IMPORTED_MODULE_11__.scene.add(plane);\n\n    // scene.background = new THREE.Color( 0x111111 );\n    // const gridHelper = new THREE.GridHelper(10, 10);\n    // scene.add(gridHelper);\n\n    // const ambientLight = new THREE.AmbientLight(0x404040);\n    // scene.add(ambientLight);\n\n    // const dirLight = new THREE.DirectionalLight(0xFFFFFF, 1);\n    // dirLight.position.set(0, 3, 0);\n    // dirLight.castShadow = true;\n    // scene.add(dirLight);\n\n    // dirLight.shadow.mapSize.width = 2 * 1024;\n    // dirLight.shadow.mapSize.height = 2 * 1024;\n\n    _libs_lights__WEBPACK_IMPORTED_MODULE_10__.add_default_lights(_index__WEBPACK_IMPORTED_MODULE_11__.scene);\n\n    _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.add_pool_spheres(S, params, _index__WEBPACK_IMPORTED_MODULE_11__.scene);\n\n    STLFilename = '../resources/4d-pool.stl'; // this one has crap pockets\n    // STLFilename = './stls/4d-pool-no-holes.stl';\n    // const texture = new THREE.TextureLoader().load( 'textures/golfball.jpg', function(t) {\n    // t.encoding = THREE.sRGBEncoding;\n    // t.mapping = THREE.EquirectangularReflectionMapping;\n    // } );\n    material = new three__WEBPACK_IMPORTED_MODULE_12__.MeshStandardMaterial({\n        color: 0x00aa00,\n        roughness: 1,\n        // map: texture,\n    });\n    // material.wireframe = true;\n\n    loadSTL();\n\n    add_table_legs();\n\n    // renderer = new THREE.WebGLRenderer( { antialias: true } );\n    // renderer.setPixelRatio( window.devicePixelRatio );\n    // renderer.setSize( window.innerWidth, window.innerHeight );\n    // renderer.shadowMap.enabled = true;\n    // renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n    // // renderer.outputEncoding = THREE.sRGBEncoding;\n    // document.body.appendChild( renderer.domElement );\n\n    // if ( params.vr ) {\n    // document.body.appendChild( VRButton.createButton( renderer ) );\n    // renderer.xr.enabled = true;\n    // CONTROLLERS.add_controllers(renderer, scene, params);\n\n    // }\n\n    // gui\n    gui = new three_examples_jsm_libs_lil_gui_module_min_js__WEBPACK_IMPORTED_MODULE_3__.GUI();\n    gui.width = 400;\n\n    gui.add(params.d4, 'cur', -params.L4, params.L4, 0.001).name('D4 location (e/q)').listen();\n    gui.add(params, 'strength', 0, 1, 0.01).name('Strength (r/f)').listen().onChange(() => {\n        _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.ray.scale.y = 2 * params.strength;\n    });\n    gui.add(params, 'track_white_ball').name('Track white ball (Space)').listen();\n    gui.add(params, 'audio').name('Audio').listen().onChange(() => {\n        if (params.audio) {\n            _libs_audio_js__WEBPACK_IMPORTED_MODULE_9__.make_listener(_index__WEBPACK_IMPORTED_MODULE_11__.camera);\n            // SPHERES.add_normal_sound_to_all_spheres();\n        }\n        // NOTE: NEED TO MAKE A DESTRUCTOR!\n    });\n    // const controls = new OrbitControls( camera, renderer.domElement );\n    // controls.target.y = params.table_height-params.L2;\n    // controls.update();\n\n    document.getElementById('hit_me').hidden = true;\n    document.getElementById(\"web_instructions\").hidden = false;\n\n    // }\n\n    // window.addEventListener('keypress', onSelectParticle, false);\n\n    // if ( params.vr ) {\n    //     POOLCUE.add_pool_cue( CONTROLLERS.controller1 );\n    //     CONTROLLERS.add_torus( CONTROLLERS.controller2, params ).then(() => {\n    //         SPHERES.add_spheres_to_torus(params, CONTROLLERS.torus1);\n    //     });\n\n    // }\n\n    _libs_buttons__WEBPACK_IMPORTED_MODULE_7__.add_scene_change_button('menu', 'Main menu', _index__WEBPACK_IMPORTED_MODULE_11__.controls, _index__WEBPACK_IMPORTED_MODULE_11__.scene, [-1.5, 1, 1.5], 0.25, [0, Math.PI / 4, 0]);\n    // BUTTONS.add_scene_change_button('hyperspheres', 'What is a hypersphere?', controls, scene, [1, 1, 1], 0.25, [0,-Math.PI/4,0]);\n\n\n    update_scoreboard();\n\n    _index__WEBPACK_IMPORTED_MODULE_11__.renderer.setAnimationLoop(function () {\n        update();\n        _index__WEBPACK_IMPORTED_MODULE_11__.renderer.render(_index__WEBPACK_IMPORTED_MODULE_11__.scene, _index__WEBPACK_IMPORTED_MODULE_11__.camera);\n    });\n\n    _libs_audio_js__WEBPACK_IMPORTED_MODULE_9__.play_track('4d-pool.mp3', _index__WEBPACK_IMPORTED_MODULE_11__.camera, 3000);\n}\n\nfunction hit_white_ball() {\n    var work = params.strength;\n    var force = work / params.dt;\n    S.simu_setExternalForce(0, 1, [force * direction.x, force * direction.z, 0, force * direction.d4]);\n}\n\nfunction onSelectParticle(event) {\n    if (event.key === 'Enter') {\n        hit_white_ball();\n    }\n    if (event.code === 'Space') {\n        event.preventDefault(); // stop page from skipping downwards\n        params.track_white_ball = !params.track_white_ball;\n    }\n    else if (event.key === \"e\") {\n        params.track_white_ball = false;\n        if (params.d4.cur < params.d4.max) {\n            params.d4.cur += 0.1 * params.radius;\n            replace_meshes();\n        }\n    }\n    else if (event.key === \"q\") {\n        params.track_white_ball = false;\n        if (params.d4.cur > params.d4.min) {\n            params.d4.cur -= 0.1 * params.radius;\n            replace_meshes();\n        }\n    }\n    else if (event.key === \"f\") {\n        if (params.strength > 0) {\n            params.strength -= 0.01;\n        }\n    }\n    else if (event.key === \"r\") {\n        params.strength += 0.01;\n    }\n}\n\n\n// function onWindowResize(){\n\n//     camera.aspect = window.innerWidth / window.innerHeight;\n//     camera.updateProjectionMatrix();\n\n//     renderer.setSize( window.innerWidth, window.innerHeight );\n\n//     if ( isMobile ) {\n//         gui.width = window.innerWidth - 30;\n//     }\n\n// }\n\nfunction add_table_legs() {\n    let thickness = 2 * params.radius;\n    let cylinder = new three__WEBPACK_IMPORTED_MODULE_12__.CylinderGeometry(thickness, thickness, 0.98 * (params.table_height - params.L2), Math.pow(2, params.quality), Math.pow(2, params.quality));\n    let material = new three__WEBPACK_IMPORTED_MODULE_12__.MeshStandardMaterial({ color: 0xaaaaaa });\n\n    let leg = new three__WEBPACK_IMPORTED_MODULE_12__.Mesh(cylinder, material);\n    leg.position.set(0.75 * (-params.L1 + thickness), (params.table_height - params.L2) / 2., -params.L3 + thickness);\n    _index__WEBPACK_IMPORTED_MODULE_11__.scene.add(leg.clone());\n    leg.position.set(0.75 * (params.L1 - thickness), (params.table_height - params.L2) / 2., -params.L3 + thickness);\n    _index__WEBPACK_IMPORTED_MODULE_11__.scene.add(leg.clone());\n    leg.position.set(0.75 * (-params.L1 + thickness), (params.table_height - params.L2) / 2., params.L3 - thickness);\n    _index__WEBPACK_IMPORTED_MODULE_11__.scene.add(leg.clone());\n    leg.position.set(0.75 * (params.L1 - thickness), (params.table_height - params.L2) / 2., params.L3 - thickness);\n    _index__WEBPACK_IMPORTED_MODULE_11__.scene.add(leg);\n\n}\n\nfunction update() {\n\n    _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.move_spheres(S, params);\n    if (params.audio) {\n        _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.update_fixed_sounds(S, params);\n    }\n\n    if (params.vr) {\n        params.track_white_ball = false;\n        // SPHERES.move_spheres_on_torus(params,CONTROLLERS.torus1);\n        // if ( CONTROLLERS.controller2.userData.isSqueezing ) { params = CONTROLLERS.update_higher_dims(CONTROLLERS.controller2, params) }\n\n        let end_of_pool_cue = new three__WEBPACK_IMPORTED_MODULE_12__.Vector3();\n\n        _libs_PoolCue_js__WEBPACK_IMPORTED_MODULE_8__.small_sphere.getWorldPosition(end_of_pool_cue);\n        let nice_d4 = clamp(params.d4.cur, params.d4.min, params.d4.max);\n\n        S.simu_fixParticle(params.N, [end_of_pool_cue.x,\n        end_of_pool_cue.y,\n        end_of_pool_cue.z,\n            nice_d4]);\n    }\n    // console.log(controls.player.position)\n    direction.copy(_libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.spheres.children[0].position);\n    direction.sub(_index__WEBPACK_IMPORTED_MODULE_11__.controls.player.position);\n    let d4offset = params.d4.cur - _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.x[0][3];\n    var l = Math.sqrt(direction.x * direction.x + direction.z * direction.z + d4offset * d4offset);\n    direction.x /= l;\n    // direction.y /= l;\n    direction.z /= l;\n    direction.d4 = d4offset / l;\n\n    _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.ray.rotation.x = -Math.atan2(direction.z, direction.x);\n    // console.log(SPHERES.spheres.children[0].position)\n    // console.log(direction)\n\n    S.simu_step_forward(20);\n\n    check_pockets();\n\n    if (params.track_white_ball) {\n        if (NDsolids !== undefined) {\n            x = S.simu_getX();\n            if (params.d4.cur !== x[0][3]) {\n                params.d4.cur = x[0][3];\n                replace_meshes();\n            }\n        }\n    }\n\n    _index__WEBPACK_IMPORTED_MODULE_11__.controls.update();\n\n}\n\nlet pocket_locs = [\n    [-params.L1, -params.L3],\n    [-params.L1, params.L3],\n    [params.L1, -params.L3],\n    [params.L1, params.L3],\n    [0, -params.L3],\n    [0, params.L3],\n];\n\nfunction in_pocket(loc) {\n    let retval = false;\n\n    // should work for actual pockets:\n    // if ( x[1] < params.table_height ) {\n    //     console.log('fallen off table (hopefully out of a hole)')\n    //     retval = true;\n    // }\n\n    pocket_locs.forEach(pocket => {\n        if (Math.pow(loc[0] - pocket[0], 2) + Math.pow(loc[1] - pocket[1], 2) < params.pocket_size * params.pocket_size) {\n            console.log('fallen off table (hopefully out of a hole)')\n            retval = true;\n        }\n    });\n    return retval;\n}\n\nfunction check_pockets() {\n    for (let i = 0; i < params.N; i++) {\n        var object = _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.spheres.children[i];\n        if (!(i in sunk_balls)) {\n            if (in_pocket(_libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.x[i])) {\n                if (i == 0) {\n                    console.log('sunk white ball')\n                    S.simu_fixParticle(0, params.white_ball_initial_loc)\n                }\n                else if (i == 11) {\n                    console.log('sunk black ball')\n                    if (sunk_balls.length < params.N - 1) {\n                        alert('You need to sink all of the coloured balls before the black ball. You lose.')\n                    } else {\n                        alert('You win!')\n                    }\n                    set_ball_positions();\n                }\n                else {\n                    console.log('SUNK BALL ' + String(i))\n                    // object.visible = false;\n                    sunk_balls.push(i)\n                    S.simu_fixParticle(i, [1.1 * params.L1, params.table_height, sunk_balls.length * 2 * params.radius, 0])\n                    S.simu_setFrozen(i);\n\n                    update_scoreboard();\n                }\n            }\n        }\n    }\n}\n\nasync function NDDEMPhysics() {\n\n    await DEMCGND().then((NDDEMCGLib) => {\n        if (params.dimension == 3) {\n            S = new NDDEMCGLib.DEMCG3D(params.N_real);\n        } else if (params.dimension == 4) {\n            S = new NDDEMCGLib.DEMCG4D(params.N_real);\n        } else if (params.dimension == 5) {\n            S = new NDDEMCGLib.DEMCG5D(params.N_real);\n\n        }\n        finish_setup();\n\n        // // overload for old DEMND instead of DEMCGND\n        // S.simu_getRadii = S.getRadii;\n        // S.simu_getX = S.getX;\n        // S.simu_getOrientation = S.getOrientation;\n        // S.simu_getVelocity = S.getVelocity;\n        // S.simu_getContactInfos = S.getContactInfos;\n\n    });\n\n\n    function finish_setup() {\n        S.simu_interpret_command(\"dimensions \" + String(params.dimension) + \" \" + String(params.N_real));\n\n        S.simu_interpret_command(\"radius -1 \" + String(params.radius));\n        // now need to find the mass of a particle with diameter 1\n\n        S.simu_interpret_command(\"mass -1 \" + String(params.particle_mass));\n        S.simu_interpret_command(\"auto rho\");\n        S.simu_interpret_command(\"auto mass\");\n        S.simu_interpret_command(\"auto inertia\");\n        S.simu_interpret_command(\"auto skin\");\n\n        S.simu_interpret_command(\"boundary 0 WALL -\" + String(params.L1) + \" \" + String(params.L1));\n        S.simu_interpret_command(\"boundary 1 WALL -\" + String(params.L3) + \" \" + String(params.L3));\n        S.simu_interpret_command(\"boundary 2 WALL \" + String(-params.L2 + params.table_height) + \" \" + String(params.L2 + params.table_height));\n        S.simu_interpret_command(\"boundary 3 WALL -\" + String(params.L4) + \" \" + String(params.L4));\n        // S.interpret_command(\"body \" + STLFilename);\n        S.simu_interpret_command(\"gravity 0 0 -9.81 0\");\n        // S.interpret_command(\"auto location randomdrop\");\n\n        set_ball_positions();\n\n        let tc = 20 * params.dt;\n        let rest = 0.5; // super low restitution coeff to dampen out quickly\n        let vals = _libs_SphereHandler_js__WEBPACK_IMPORTED_MODULE_4__.setCollisionTimeAndRestitutionCoefficient(tc, rest, params.particle_mass)\n\n        S.simu_interpret_command(\"set Kn \" + String(vals.stiffness));\n        S.simu_interpret_command(\"set Kt \" + String(0.8 * vals.stiffness));\n        S.simu_interpret_command(\"set GammaN \" + String(vals.dissipation));\n        S.simu_interpret_command(\"set GammaT \" + String(vals.dissipation));\n        S.simu_interpret_command(\"set Mu 0.1\");\n        S.simu_interpret_command(\"set Mu_wall 0.5\");\n        S.simu_interpret_command(\"set damping 6e-4\");\n        S.simu_interpret_command(\"set T 150\");\n        S.simu_interpret_command(\"set dt \" + String(params.dt));\n        S.simu_interpret_command(\"set tdump 1000000\"); // how often to calculate wall forces\n        S.simu_finalise_init();\n    }\n}\n\nfunction set_ball_positions() {\n    let n = 1;\n    let offset = params.L1 / 2;\n\n    params.white_ball_initial_loc = [offset, 0, params.table_height - params.L2 + params.radius, 0.001 * (Math.random() - 0.5)];\n    S.simu_interpret_command(\"location \" + String(0) + \" \"\n        + String(params.white_ball_initial_loc[0]) + \" \"\n        + String(params.white_ball_initial_loc[1]) + \" \"\n        + String(params.white_ball_initial_loc[2]) + \" \"\n        + String(params.white_ball_initial_loc[3])); // first ball is the white ball\n\n    for (var k = 0; k < params.pyramid_size; k++) {\n        let cur_pyramid_length = params.pyramid_size - k;\n        let w = k * 1.825 * params.radius;\n        for (var i = 0; i < cur_pyramid_length; i++) {\n            for (var j = 0; j < cur_pyramid_length - i; j++) {\n                let x = i * 1.82 * params.radius - cur_pyramid_length * params.radius + params.radius - offset;\n                let y = j * 2.01 * params.radius - (cur_pyramid_length - i) * params.radius + params.radius;// - i%2*radius;\n                S.simu_interpret_command(\"location \" + String(n) + \" \" + String(x) + \" \" + String(y) + \" \" + String(params.table_height - params.L2 + params.radius) + \" \" + String(w));\n                n++;\n                if (k > 0) { S.simu_interpret_command(\"location \" + String(n) + \" \" + String(x) + \" \" + String(params.table_height - params.L2 + params.radius) + \" \" + String(y) + \" \" + String(-w)); n++; }\n\n            }\n        }\n    }\n\n    // add the cue stick\n    if (params.vr) {\n        S.simu_interpret_command(\"location \" + String(params.N) + \" 0 0 0 0\");\n\n        // let pool_cue_particle_volume = Math.PI*Math.PI*Math.pow(POOLCUE.small_end_radius,4)/2.;\n        // let pool_cue_particle_mass = params.particle_volume * params.particle_density/1e3;\n        // S.setRadius(params.N, POOLCUE.small_end_radius);\n        // S.setMass(params.N, params.particle_mass/10.);\n    }\n}\n\nfunction loadSTL() {\n    meshes = new three__WEBPACK_IMPORTED_MODULE_12__.Group;\n    const loader = new _libs_NDSTLLoader_js__WEBPACK_IMPORTED_MODULE_5__.NDSTLLoader();\n    loader.load([STLFilename], function (solids) {\n        NDsolids = solids;\n        replace_meshes();\n    })\n}\n\nfunction replace_meshes() {\n    if (NDsolids.length > 0) {\n        if (meshes !== undefined) {\n            _index__WEBPACK_IMPORTED_MODULE_11__.scene.remove(meshes);\n            dispose_children(meshes);\n            meshes = new three__WEBPACK_IMPORTED_MODULE_12__.Group();\n        }\n        meshes = (0,_libs_NDSTLLoader_js__WEBPACK_IMPORTED_MODULE_5__.renderSTL)(meshes, NDsolids, _index__WEBPACK_IMPORTED_MODULE_11__.scene, material, params.d4.cur);\n        meshes.position.y = params.table_height;\n        _index__WEBPACK_IMPORTED_MODULE_11__.scene.add(meshes);\n    }\n}\n\nfunction update_scoreboard() {\n    let board = document.getElementById('N_tag');\n    board.innerHTML = String(params.N - sunk_balls.length); //+ ' to go';\n}\n\nfunction get_num_particles(L) {\n    let N = 0;\n    let i = 1;\n    for (var n = L; n > 0; n--) {\n        N += i * n;\n        i += 2;\n    }\n    return N + 1; // adding the white ball\n}\n\nfunction clamp(a, min, max) {\n    if (a < min) { return min }\n    else if (a > max) { return max }\n    else { return a }\n}\n\nfunction dispose_children(target) {\n    for (var i = 0; i < target.children.length; i++) {\n        target.children[i].geometry.dispose();\n        target.children[i].material.dispose();\n    }\n}\n\n\n//# sourceURL=webpack://granular-vr/./src/4d-pool.js?");

/***/ }),

/***/ "./text-to-speech/4d-pool.mp3":
/*!************************************!*\
  !*** ./text-to-speech/4d-pool.mp3 ***!
  \************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("module.exports = __webpack_require__.p + \"e9298d53451a534a9a5c.mp3\";\n\n//# sourceURL=webpack://granular-vr/./text-to-speech/4d-pool.mp3?");

/***/ })

}]);